# dreamprf-diary-bot

Telegram bot for baby's dreams diary. Diary created by [Ekaterina Parfenova](https://www.instagram.com/ekaterina.prf/), baby sleep consultant.

## Bot Commands

- start
- help
- night
- end
- last

## Issues

- bug: state persists when device changing (maybe not bug?)
- add: empty user_sid.json to git
- duplicate entries in user-sid.json

## Credits

- Alexey Goloburdin: https://github.com/alexey-goloburdin/botanim-bot/
- MasterGroosha: https://mastergroosha.github.io/aiogram-2-guide/

## Todo

1. [x] Добавлять ночные пробуждения простым нажатием на кнопку
   - [x] если просто ввести команду, то НП добавится с текущим временем
   - (???) если ввести команду и после нее текст (так можно?), то ИП добавится с указанным временем (хз)
     - можно указывать целое число - это минуты назад
     - можно указывать время в формате НН:ММ - это часы и минуты в прошлом, ближайшие к текущей дате
   - [x] бот должеен писать НП в соответствующее поле гуглдока
2. [x] После добавления НП опционально можно ввести комментарии к последнему ввееденному НП
3. [x] Получить в кнопках все просыпания последней (или текущей) ночи. По кнопке давать вводить текст и добавлять этот текст как комментарий (перезаписывая текущий? показывать текущий в реплае? 
4. Задавать дату старта курса и правильно проставлять название листа в зависимости от даты.
5. Удалять запись, если введен комментарий 'delete'.
6. Посмотреть расписание предыдущего дня: проснулись утром, уснули в саду, проснулись в саду, уснули на ночь, НП, проснулись сегодня
7. Смотреть картинки (графики) динамики ДС, НС, колво НП
8. Считать статистику: среднее кол-во просыпаний, средняя длительность ВБ1 - ДС - ВБ2 - НС. Возможно, объединить с графиками.

## Refactoring

- [ ] Разделить на слои: обработка команд, бизнес-логика
- [ ] Выделить хэндлеры в отдельные файлы
- [ ] Не запрашивать даты/листы на каждое действие; получать их однократно и где-то хранить (state?) для юзера; перезагрузить при необходимости
- [ ] isort, black, flake8 + github actions

---

Телеграм-бот для записи ночных пробуждений и работы с дневником сна от Екатерины Парфеновой, консультанта по детскому сну.

## Команды бота:

- start
- help
- night
- end
- last

## Благодарности

- Алексей Голобурдин (Диджитализируй!): https://github.com/alexey-goloburdin/botanim-bot/
- MasterGroosha: https://mastergroosha.github.io/aiogram-2-guide/
- 